<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>CSAPP 学习笔记 | Vesper's Blog</title><meta name="keywords" content="个人博客,笔记,计算机科学与技术"><meta name="author" content="Vesper,1261987849@qq.com"><meta name="copyright" content="Vesper"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="CMU15-213学习笔记整理以及Lab的解法整理。">
<meta property="og:type" content="article">
<meta property="og:title" content="CSAPP 学习笔记">
<meta property="og:url" content="https://yindongpeng.com/2021/03/15/CSAPP%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Vesper&#39;s Blog">
<meta property="og:description" content="CMU15-213学习笔记整理以及Lab的解法整理。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Vesper-Y/Picture_bed/img/202002021512%20(1).png">
<meta property="article:published_time" content="2021-03-15T03:07:50.962Z">
<meta property="article:modified_time" content="2021-03-20T12:39:58.548Z">
<meta property="article:author" content="Vesper">
<meta property="article:tag" content="个人博客">
<meta property="article:tag" content="笔记">
<meta property="article:tag" content="计算机科学与技术">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Vesper-Y/Picture_bed/img/202002021512%20(1).png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://yindongpeng.com/2021/03/15/CSAPP%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/favicon-16x16.png"/><link rel="mask-icon" href="/img/siteicon/safari-pinned-tab.svg" color="#5bbad5"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Vesper-Y/Vesper-Y.github.io@main/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?bfa951942328aaa8a94cdbd505f085d7";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-WYQWWZL4XT"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-WYQWWZL4XT');
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"E5QJ04BIUW","apiKey":"d331bf1fdd39fa40d8b7fe280f5cedb7","indexName":"Blog","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-center"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CSAPP 学习笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-03-20 20:39:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    document.addEventListener('pjax:complete', detectApple)})(window)</script><link rel="stylesheet" href="/css/style.css" media="defer" onload="this.media='all'"><style type="text/css">.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body{left:-66px!important}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover{left:0!important}</style><meta name="generator" content="Hexo 5.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Music"><i class="fa-fw /music/"></i><span> 0</span></a></li><li><a class="site-page child" href="/Movie"><i class="fa-fw /movies/"></i><span> 1</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/Vesper-Y/Picture_bed/img/202002021512%20(1).png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Vesper's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Music"><i class="fa-fw /music/"></i><span> 0</span></a></li><li><a class="site-page child" href="/Movie"><i class="fa-fw /movies/"></i><span> 1</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CSAPP 学习笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-03-15T03:07:50.962Z" title="发表于 2021-03-15 11:07:50">2021-03-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-03-20T12:39:58.548Z" title="更新于 2021-03-20 20:39:58">2021-03-20</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>17分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="CSAPP 学习笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="CSAPP-学习笔记"><a href="#CSAPP-学习笔记" class="headerlink" title="CSAPP 学习笔记"></a>CSAPP 学习笔记</h1><h2 id="Lab0-C-Programming-Lab"><a href="#Lab0-C-Programming-Lab" class="headerlink" title="Lab0  C Programming Lab"></a>Lab0  C Programming Lab</h2><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>The ﬁle queue.h contains declarations of the following structures:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Linked list element */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">list</span> <span class="title">ele</span> &#123;</span></span><br><span class="line"><span class="keyword">char</span> *value;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">list</span> <span class="title">ele</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125; <span class="built_in">list</span> ele t;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Queue structure */</span> </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span> </span><br><span class="line"><span class="built_in">list</span> ele t *head; </span><br><span class="line">&#125; <span class="built_in">queue</span> t;</span><br></pre></td></tr></table></figure>


<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/Vesper-Y/Picture_bed/img/image-20210320201933827.png" alt="image-20210320201933827"></p>
<p>Figure 1: <strong>Linked-list implementation of a queue</strong>. Each list element has a value ﬁeld, pointing to an array of characters (C’s representation of strings), and a next ﬁeld pointing to the next list element. Characters are encoded according to the ASCII encoding (shown in hexadecimal.)</p>
<p>These are combined to implement a queue of strings, as illustrated in Figure 1. The top-level representation of a queue is a structure of type queue_t. In the starter code, this structure contains only a single ﬁeld head, but you will want to add other ﬁelds. The queue contents are represented as a singly-linked list, with each element represented by a structure of type list_ele_t, having ﬁelds value and next, storing a pointer to a string and a pointer to the next list element, respectively. The ﬁnal list element has its next pointer set to NULL. You may add other ﬁelds to the structure list_ele, although you need not do so.</p>
<p>Recall that a string is represented in C as an array of values of type char. In most machines, data type char is represented as a single byte. To store a string of length l, the array has l +1 elements, with the ﬁrst l storing the codes (typically ASCII format) for the characters and the ﬁnal one being set to 0. The value ﬁeld of the list element is a pointer to the array of characters. The ﬁgure indicates the representation of the list [“cab”, “bead”, “cab”], with characters a–e represented in hexadecimal as ASCII codes 61–65. Observe how the two instances of the string “cab” are represented by separate arrays—each list element should have a separate copy of its string.</p>
<p>In our C code, a queue is a pointer of type queue_t *. We distinguish two special cases: a NULL queue is one for which the pointer has value NULL. An empty queue is one pointing to a valid structure, but the head ﬁeld has value NULL. Your code will need to deal properly with both of these cases, as well as queues containing one or more elements.</p>
<h3 id="Programming-Task"><a href="#Programming-Task" class="headerlink" title="Programming Task"></a>Programming Task</h3><p>Your task is to modify the code in queue.h and queue.c to fully implement the following functions.</p>
<p>queue new: Create a new, empty queue.</p>
<p>queue free: Free all storage used by a queue.</p>
<p>queue insert head: Attempt to insert a new element at the head of the queue (LIFO discipline).</p>
<p>queue insert tail: Attempt to insert a new element at the tail of the queue (FIFO discipline). queue remove head: Attempt to remove the element at the head of the queue.</p>
<p>queue size: Compute the number of elements in the queue.</p>
<p>queue reverse: Reorder the list so that the queue elements are reversed in order. This function</p>
<p>should not allocate or free any list elements (either directly or via calls to other functions</p>
<p>that allocate or free list elements.) Instead, it should rearrange the existing elements.</p>
<p>More details can be found in the comments in these two ﬁles, including how to handle invalid operations (e.g., removing from an empty or NULL queue), and what side eﬀects and return values the functions should have.</p>
<p>For functions that provide strings as arguments, you must create and store a copy of the string by calling malloc to allocate space (remember to include space for the terminating character) and then copying from the source to the newly allocated space. When it comes time to free a list element, you must also free the space used by the string. You cannot assume any ﬁxed upper bound on the length of a string—you must allocate space for each string based on its length. Note: malloc, calloc, and realloc are the only supported functions in this lab for memory allocation, any other functions that allocate memory on the heap may cause you to lose points.</p>
<p>Two of the functions, queue_insert_tail and queue_size, will require some eﬀort on your part to meet the required performance standards. Naive implementations would require O(n) steps for a queue with n elements. We require that your implementations operate in time O(1), i.e., that the operation will require only a ﬁxed number of steps, regardless of the queue size. You can do this by including other ﬁelds in the queue_t data structure and managing these values properly as list elements are inserted, removed and reversed. Please work on ﬁnding a solution better than the O(n 2 ) solution for all of the functions.</p>
<p>Your program will be tested on queues with over 1,000,000 elements. You will ﬁnd that you cannot operate on such long lists using recursive functions, since that would require too much stack space. Instead, you need to use a loop to traverse the elements in a list.</p>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file queue.h</span></span><br><span class="line"><span class="comment"> * @brief Header file for implementing queue operations.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Assignment for basic C skills diagnostic.</span></span><br><span class="line"><span class="comment"> * Developed for courses 15-213/18-213/15-513 by R. E. Bryant, 2017</span></span><br><span class="line"><span class="comment"> * Extended to store strings, 2018</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">TODO:</span> fill in your name and Andrew ID</span></span><br><span class="line"><span class="comment"> * @author XXX &lt;XXX@andrew.cmu.edu&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/************** Data structure declarations ****************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief Linked list element containing a string.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * You shouldn&#x27;t change this struct.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">list_ele</span> &#123;</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @brief Pointer to a char array containing a string value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * The memory for this string should be explicitly allocated and freed</span></span><br><span class="line"><span class="comment">     * whenever an element is inserted and removed from the queue.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">char</span> *value;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @brief Pointer to the next element in the linked list.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_ele</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125; <span class="keyword">list_ele_t</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief Queue structure representing a list of elements</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @brief Pointer to the first element in the queue, or NULL if the</span></span><br><span class="line"><span class="comment">     *        queue is empty.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">list_ele_t</span> *head;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * <span class="doctag">TODO:</span> You will need to add more fields to this structure</span></span><br><span class="line"><span class="comment">     *       to efficiently implement q_size and q_insert_tail</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">list_ele_t</span> *tail;</span><br><span class="line">    <span class="keyword">int</span> size;</span><br><span class="line">&#125; <span class="keyword">queue_t</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/************** Operations on queue ************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Create empty queue. */</span></span><br><span class="line"><span class="function"><span class="keyword">queue_t</span> *<span class="title">queue_new</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Free ALL storage used by queue. */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">queue_free</span><span class="params">(<span class="keyword">queue_t</span> *q)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Attempt to insert element at head of queue. */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">queue_insert_head</span><span class="params">(<span class="keyword">queue_t</span> *q, <span class="keyword">const</span> <span class="keyword">char</span> *s)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Attempt to insert element at tail of queue. */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">queue_insert_tail</span><span class="params">(<span class="keyword">queue_t</span> *q, <span class="keyword">const</span> <span class="keyword">char</span> *s)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Attempt to remove element from head of queue. */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">queue_remove_head</span><span class="params">(<span class="keyword">queue_t</span> *q, <span class="keyword">char</span> *sp, <span class="keyword">size_t</span> bufsize)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Return number of elements in queue. */</span></span><br><span class="line"><span class="function"><span class="keyword">size_t</span> <span class="title">queue_size</span><span class="params">(<span class="keyword">queue_t</span> *q)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Reverse elements in queue */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">queue_reverse</span><span class="params">(<span class="keyword">queue_t</span> *q)</span></span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file queue.c</span></span><br><span class="line"><span class="comment"> * @brief Implementation of a queue that supports FIFO and LIFO operations.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This queue implementation uses a singly-linked list to represent the</span></span><br><span class="line"><span class="comment"> * queue elements. Each queue element stores a string value.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Assignment for basic C skills diagnostic.</span></span><br><span class="line"><span class="comment"> * Developed for courses 15-213/18-213/15-513 by R. E. Bryant, 2017</span></span><br><span class="line"><span class="comment"> * Extended to store strings, 2018</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">TODO:</span> fill in your name and Andrew ID</span></span><br><span class="line"><span class="comment"> * @author XXX &lt;XXX@andrew.cmu.edu&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;harness.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;queue.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief Allocates a new queue</span></span><br><span class="line"><span class="comment"> * @return The new queue, or NULL if memory allocation failed</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">queue_t</span> *<span class="title">queue_new</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">queue_t</span> *q = (<span class="keyword">queue_t</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">queue_t</span>));</span><br><span class="line">    <span class="comment">/* What if malloc returned NULL? */</span></span><br><span class="line">    <span class="keyword">if</span> (q == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        q-&gt;head = <span class="literal">NULL</span>;</span><br><span class="line">        q-&gt;tail = <span class="literal">NULL</span>;</span><br><span class="line">        q-&gt;size = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> q;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief Frees all memory used by a queue</span></span><br><span class="line"><span class="comment"> * @param[in] q The queue to free</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">queue_free</span><span class="params">(<span class="keyword">queue_t</span> *q)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* How about freeing the list elements and the strings? */</span></span><br><span class="line">    <span class="keyword">if</span> (q == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (q -&gt; head != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">list_ele_t</span> *p = q -&gt; head;</span><br><span class="line">        <span class="keyword">list_ele_t</span> *next = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (p)</span><br><span class="line">        &#123;</span><br><span class="line">            next = p -&gt; next;</span><br><span class="line">            <span class="keyword">if</span> (p -&gt; value != <span class="literal">NULL</span>)</span><br><span class="line">                <span class="built_in">free</span>(p -&gt; value);</span><br><span class="line">            <span class="built_in">free</span>(p);</span><br><span class="line">            p = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    for (int i = 0; i &lt; q -&gt; size; i++) &#123;</span></span><br><span class="line"><span class="comment">        list_ele_t* p = q -&gt; head;</span></span><br><span class="line"><span class="comment">        if (q -&gt; head -&gt; next != NULL)</span></span><br><span class="line"><span class="comment">            q -&gt; head = q -&gt; head -&gt; next;</span></span><br><span class="line"><span class="comment">        if (p -&gt; value != NULL)</span></span><br><span class="line"><span class="comment">            free(p -&gt; value);</span></span><br><span class="line"><span class="comment">        free(p);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="comment">/* Free queue structure */</span></span><br><span class="line">    <span class="built_in">free</span>(q);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief Attempts to insert an element at head of a queue</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This function explicitly allocates space to create a copy of `s`.</span></span><br><span class="line"><span class="comment"> * The inserted element points to a copy of `s`, instead of `s` itself.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param[in] q The queue to insert into</span></span><br><span class="line"><span class="comment"> * @param[in] s String to be copied and inserted into the queue</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @return true if insertion was successful</span></span><br><span class="line"><span class="comment"> * @return false if q is NULL, or memory allocation failed</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">queue_insert_head</span><span class="params">(<span class="keyword">queue_t</span> *q, <span class="keyword">const</span> <span class="keyword">char</span> *s)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* What should you do if the q is NULL? */</span></span><br><span class="line">    <span class="keyword">if</span> (q == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">list_ele_t</span>* newh = (<span class="keyword">list_ele_t</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">list_ele_t</span>));</span><br><span class="line">    <span class="keyword">if</span> (newh == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">/* Don&#x27;t forget to allocate space for the string and copy it */</span></span><br><span class="line">    newh -&gt; value = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="built_in">strlen</span>(s) + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">/* What if either call to malloc returns NULL? */</span></span><br><span class="line">    <span class="keyword">if</span> (newh -&gt; value == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">free</span>(newh);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">strcpy</span>(newh-&gt;value, s);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (q-&gt;size == <span class="number">0</span>) &#123;</span><br><span class="line">        q-&gt;head = newh;</span><br><span class="line">        q-&gt;tail = newh;</span><br><span class="line">        newh-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        newh-&gt;next = q-&gt;head;</span><br><span class="line">        q-&gt;head = newh;</span><br><span class="line">    &#125;</span><br><span class="line">    q-&gt;size++;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief Attempts to insert an element at tail of a queue</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This function explicitly allocates space to create a copy of `s`.</span></span><br><span class="line"><span class="comment"> * The inserted element points to a copy of `s`, instead of `s` itself.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param[in] q The queue to insert into</span></span><br><span class="line"><span class="comment"> * @param[in] s String to be copied and inserted into the queue</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @return true if insertion was successful</span></span><br><span class="line"><span class="comment"> * @return false if q is NULL, or memory allocation failed</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">queue_insert_tail</span><span class="params">(<span class="keyword">queue_t</span> *q, <span class="keyword">const</span> <span class="keyword">char</span> *s)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* You need to write the complete code for this function */</span></span><br><span class="line">    <span class="comment">/* Remember: It should operate in O(1) time */</span></span><br><span class="line">    <span class="keyword">if</span> (q == <span class="literal">NULL</span> || q -&gt; tail == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">list_ele_t</span> *newt = (<span class="keyword">list_ele_t</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">list_ele_t</span>));</span><br><span class="line">    <span class="keyword">if</span>(newt == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    newt -&gt; value = (<span class="keyword">char</span>*)<span class="built_in">malloc</span>(<span class="built_in">strlen</span>(s) + <span class="number">1</span>);</span><br><span class="line">    newt -&gt; next = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(newt -&gt; value == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">free</span>(newt);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">strcpy</span>(newt -&gt; value, s);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (q-&gt;head == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        q-&gt;head = newt;</span><br><span class="line">        q-&gt;tail = newt;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        q-&gt;tail-&gt;next = newt;</span><br><span class="line">        q-&gt;tail = newt;</span><br><span class="line">    &#125;<span class="comment">/*</span></span><br><span class="line"><span class="comment">    list_ele_t *newe = (list_ele_t *)malloc(sizeof(list_ele_t));</span></span><br><span class="line"><span class="comment">    if (newe == NULL)</span></span><br><span class="line"><span class="comment">        return false;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    newe-&gt;value = (char *)malloc(sizeof(strlen(s) + 1));</span></span><br><span class="line"><span class="comment">    if (newe-&gt;value == NULL) &#123;</span></span><br><span class="line"><span class="comment">        free(newe);</span></span><br><span class="line"><span class="comment">        return false;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    strcpy(newe-&gt;value, s);</span></span><br><span class="line"><span class="comment">    newe-&gt;next = NULL;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    if (q-&gt;size == 0) &#123;</span></span><br><span class="line"><span class="comment">        q-&gt;head = newe;</span></span><br><span class="line"><span class="comment">        q-&gt;tail = newe;</span></span><br><span class="line"><span class="comment">    &#125; else &#123;</span></span><br><span class="line"><span class="comment">        q-&gt;tail-&gt;next = newe;</span></span><br><span class="line"><span class="comment">        q-&gt;tail = newe;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    q-&gt;size++;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief Attempts to remove an element from head of a queue</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * If removal succeeds, this function frees all memory used by the</span></span><br><span class="line"><span class="comment"> * removed list element and its string value before returning.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * If removal succeeds and `buf` is non-NULL, this function copies up to</span></span><br><span class="line"><span class="comment"> * `bufsize - 1` characters from the removed string into `buf`, and writes</span></span><br><span class="line"><span class="comment"> * a null terminator &#x27;\0&#x27; after the copied string.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param[in]  q       The queue to remove from</span></span><br><span class="line"><span class="comment"> * @param[out] buf     Output buffer to write a string value into</span></span><br><span class="line"><span class="comment"> * @param[in]  bufsize Size of the buffer `buf` points to</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @return true if removal succeeded</span></span><br><span class="line"><span class="comment"> * @return false if q is NULL or empty</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">queue_remove_head</span><span class="params">(<span class="keyword">queue_t</span> *q, <span class="keyword">char</span> *buf, <span class="keyword">size_t</span> bufsize)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* You need to fix up this code. */</span></span><br><span class="line">    <span class="keyword">if</span> (q == <span class="literal">NULL</span> || q -&gt; head == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (buf == <span class="literal">NULL</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strlen</span>(q -&gt; head -&gt; value) &lt; bufsize)</span><br><span class="line">            <span class="built_in">strcpy</span>(buf, q -&gt; head -&gt; value);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bufsize - <span class="number">1</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                *(buf + i) = q -&gt; head -&gt; value[i];</span><br><span class="line">            &#125;</span><br><span class="line">            *(buf + bufsize - <span class="number">1</span>) = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (q -&gt; head -&gt; value == <span class="literal">NULL</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">free</span>(q -&gt; head -&gt;value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">list_ele_t</span>* tmp = q -&gt; head;</span><br><span class="line">    q -&gt; head = q -&gt; head -&gt; next;</span><br><span class="line">    <span class="built_in">free</span>(tmp);</span><br><span class="line">    q -&gt; size--;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief Returns the number of elements in a queue</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This function runs in O(1) time.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param[in] q The queue to examine</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @return the number of elements in the queue, or</span></span><br><span class="line"><span class="comment"> *         0 if q is NULL or empty</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">size_t</span> <span class="title">queue_size</span><span class="params">(<span class="keyword">queue_t</span> *q)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* You need to write the code for this function */</span></span><br><span class="line">    <span class="comment">/* Remember: It should operate in O(1) time */</span></span><br><span class="line">    <span class="keyword">if</span> (q == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> q-&gt;size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief Reverse the elements in a queue</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This function does not allocate or free any list elements, i.e. it does</span></span><br><span class="line"><span class="comment"> * not call malloc or free, including inside helper functions. Instead, it</span></span><br><span class="line"><span class="comment"> * rearranges the existing elements of the queue.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param[in] q The queue to reverse</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">queue_reverse</span><span class="params">(<span class="keyword">queue_t</span> *q)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* You need to write the code for this function */</span></span><br><span class="line">    <span class="keyword">if</span> (q == <span class="literal">NULL</span> || q -&gt; head == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (q -&gt; size == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">list_ele_t</span> *beg, *mid, *end;</span><br><span class="line"></span><br><span class="line">    beg = q -&gt; head;</span><br><span class="line">    mid = q -&gt; head -&gt; next;</span><br><span class="line">    beg -&gt; next = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        end = mid -&gt; next;</span><br><span class="line">        mid -&gt; next = beg;</span><br><span class="line">        beg = mid;</span><br><span class="line">        mid = end;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(mid == <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            q -&gt; tail = q -&gt; head;</span><br><span class="line">            q -&gt; head = beg;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;   </span><br><span class="line"> </span><br><span class="line">    &#125;   </span><br><span class="line"><span class="comment">/*    if (q == NULL || q -&gt; head == NULL)</span></span><br><span class="line"><span class="comment">        return;</span></span><br><span class="line"><span class="comment">    if (q -&gt; size == 1)</span></span><br><span class="line"><span class="comment">        return;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    list_ele_t* beg = NULL;</span></span><br><span class="line"><span class="comment">    list_ele_t* mid = q -&gt; head;</span></span><br><span class="line"><span class="comment">    list_ele_t* end = head -&gt; next;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    while(true)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        mid -&gt; next = beg;</span></span><br><span class="line"><span class="comment">        if (end == NULL)</span></span><br><span class="line"><span class="comment">            break;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        beg = mid;</span></span><br><span class="line"><span class="comment">        mid = end;</span></span><br><span class="line"><span class="comment">        end = end -&gt; next;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    q -&gt; head = mid;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> make <span class="built_in">test</span></span></span><br><span class="line"></span><br><span class="line">/usr/local/opt/llvm/bin/clang -O0 -g -Wall -Werror -std=gnu99 -fsanitize=address -o queue.o -c queue.c</span><br><span class="line">usage: grep [-abcDEFGHhIiJLlmnOoqRSsUVvwxZ] [-A num] [-B num] [-C[num]]</span><br><span class="line">	[-e pattern] [-f file] [--binary-files=value] [--color=when]</span><br><span class="line">	[--context[=num]] [--directories=action] [--label] [--line-buffered]</span><br><span class="line">	[--null] [pattern] [file ...]</span><br><span class="line"></span><br><span class="line">ERROR: Your code&#x27;s formatting does not match clang-format.</span><br><span class="line">    For details, see https://www.cs.cmu.edu/~213/codeStyle.html</span><br><span class="line">    To reformat your code, run &quot;make format&quot;.</span><br><span class="line"></span><br><span class="line">    Files checked: queue.c queue.h</span><br><span class="line"></span><br><span class="line">    You must fix this before submitting to Autolab.</span><br><span class="line"></span><br><span class="line">/usr/local/opt/llvm/bin/clang  -o qtest qtest.o report.o console.o harness.o queue.o -fsanitize=address</span><br><span class="line">chmod +x driver.py</span><br><span class="line">./driver.py</span><br><span class="line">---	Trace		Points</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-01-ops:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-01-ops.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test of insert_head and remove_head</span></span><br><span class="line">---	trace-01-ops	6/6</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-02-ops:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-02-ops.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test of insert_head, insert_tail, and remove_head</span></span><br><span class="line">---	trace-02-ops	6/6</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-03-ops:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-03-ops.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test of insert_head, insert_tail, reverse, and remove_head</span></span><br><span class="line">---	trace-03-ops	6/6</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-04-ops:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-04-ops.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test of insert_head, insert_tail, and size</span></span><br><span class="line">---	trace-04-ops	6/6</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-05-ops:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-05-ops.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test of insert_head, insert_tail, remove_head reverse, and size</span></span><br><span class="line">---	trace-05-ops	6/6</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-06-string:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-06-string.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test of truncated strings</span></span><br><span class="line">---	trace-06-string	7/7</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-07-robust:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-07-robust.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test operations on NULL queue</span></span><br><span class="line">---	trace-07-robust	7/7</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-08-robust:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-08-robust.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test operations on empty queue</span></span><br><span class="line">---	trace-08-robust	7/7</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-09-robust:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-09-robust.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test remove_head with NULL argument</span></span><br><span class="line">---	trace-09-robust	7/7</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-10-malloc:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-10-malloc.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test of malloc failure on new</span></span><br><span class="line">---	trace-10-malloc	7/7</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-11-malloc:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-11-malloc.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test of malloc failure on insert_head</span></span><br><span class="line">---	trace-11-malloc	7/7</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-12-malloc:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-12-malloc.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test of malloc failure on insert_tail</span></span><br><span class="line">---	trace-12-malloc	7/7</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-13-perf:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-13-perf.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test performance of insert_tail</span></span><br><span class="line">---	trace-13-perf	7/7</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-14-perf:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-14-perf.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test performance of size</span></span><br><span class="line">---	trace-14-perf	7/7</span><br><span class="line"></span><br><span class="line">+++ TESTING trace trace-15-perf:</span><br><span class="line">./qtest -v 1 -f ./traces/trace-15-perf.cmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> Test performance of insert_tail, size, and reverse</span></span><br><span class="line">---	trace-15-perf	7/7</span><br><span class="line">---	TOTAL		100/100</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:1261987849@qq.com">Vesper</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://yindongpeng.com/2021/03/15/CSAPP%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">https://yindongpeng.com/2021/03/15/CSAPP学习笔记/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://yindongpeng.com" target="_blank">Vesper's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-600694c265464835" async="async"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/03/28/%E6%98%A5%E5%AD%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/Vesper-Y/Picture_bed/img/v2-2d666d57cb8f9959e367bc94eeaa46c0_1440w%20(1).jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Acwing春季每日一题</div></div></a></div><div class="next-post pull-right"><a href="/2021/02/20/Git%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/Vesper-Y/Picture_bed/img/Git%E7%AC%94%E8%AE%B0%E5%B0%81%E9%9D%A2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Git 学习笔记</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CSAPP-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0"><span class="toc-number">1.</span> <span class="toc-text">CSAPP 学习笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab0-C-Programming-Lab"><span class="toc-number">1.1.</span> <span class="toc-text">Lab0  C Programming Lab</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Overview"><span class="toc-number">1.1.1.</span> <span class="toc-text">Overview</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Programming-Task"><span class="toc-number">1.1.2.</span> <span class="toc-text">Programming Task</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code"><span class="toc-number">1.1.3.</span> <span class="toc-text">Code</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 By Vesper</div><div class="footer_custom_text">I'm unstoppable.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="https://cdn.jsdelivr.net/gh/Vesper-Y/Vesper-Y.github.io@main/js/utils.js"></script><script src="https://cdn.jsdelivr.net/gh/Vesper-Y/Vesper-Y.github.io@main/js/main.js"></script><script src="https://cdn.jsdelivr.net/gh/Vesper-Y/Vesper-Y.github.io@main/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="https://cdn.jsdelivr.net/gh/Vesper-Y/Vesper-Y.github.io@main/js/search/algolia.js"></script><div class="js-pjax"><script>function loadWaline () {
  function initWaline () {
    const waline = new Waline(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://waline-red-kappa.vercel.app',
      avatar: '',
      avatarCDN: 'https://sdn.geekzu.org/avatar/',
      path: location.pathname,
      visitor: false,
      dark: 'html[data-theme="dark"]'
    }, null))
  }

  if (typeof Waline === 'function') initWaline() 
  else getScript('https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js').then(initWaline)
}

if ('Waline' === 'Waline' || !false) {
  if (false) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><div class="aplayer no-destroy" data-id="6601994583" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script src="//code.tidio.co/wf61czgsk7mf9vggjix5hwoyyz67czhq.js" async="async"></script><script>function onTidioChatApiReady() {
  window.tidioChatApi.hide();
  window.tidioChatApi.on("close", function() {
    window.tidioChatApi.hide();
  });
}
if (window.tidioChatApi) {
  window.tidioChatApi.on("ready", onTidioChatApiReady);
} else {
  document.addEventListener("tidioChat-ready", onTidioChatApiReady);
}

var chatBtnFn = () => {
  document.getElementById("chat_btn").addEventListener("click", function(){
    window.tidioChatApi.show();
    window.tidioChatApi.open();
  });
}
chatBtnFn()
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/SerokSSR/cdn/meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.removeEventListener('scroll', window.tocScrollFn)
  window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'G-WYQWWZL4XT', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>